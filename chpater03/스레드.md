---
### 스레드
---
지금까지 살펴본 프로세스는 프로그램을 실행하는 자원과 실행되는 제어의 흐름(디스패칭되는 개체)이라는 두 가지 특성으로 나누어 볼 수 있다. 현대의 운영체제는 프로세스에서 실행제어만 분리한 실행 단위를 스레드(또는 경량 프로세스(LWP,Light Weight Process))라 하고 자원 단위의 처리를 프로세스(또는 작업)로 나누어 처리한다. 그리고 프로세스에서 실행되는 제어의 흐름을 분리하면, 즉 스레드의 개념을 분리하면 실행 상태와 디스패칭의 우선순위문제를 생각해 볼 수 있다.

---
#### 스레드 개요
---
스레드는 프로세스처럼 프로세서를 사용하는 기본 단위이면서 프로그램을 실행하는 프로세스 내의 개체, 즉 명령어를 독립적으로 실행할 수 있는 하나의 제어 흐름이다. 스레드는 같은 그룹의 스레드와 코드, 주소 공간, 운영체제의 자원(파일, 신호) 등을 공유하는데, 이러한 스레드의 그룹 환경을 작업이라 한다. 따라서 스레드를 경량 프로세스(LWP, Light Weight Process)라고 부르는데, 전형적인 프로세스, 즉 중량 프로세스(HWP,Heavy Weight Process)는 스레드를 하나 가진 작업이다. 작업에 스레드가 없으면 아무 일도 할 수 없으므로 작업에는 반드시 스레드가 있어야 한다. 

프로세스는 스레드를 하나 이상 가지며 각 스레드는 다음 내용을 포함한다.

- 스레드 실행 시의 상태(실행,준비 등)

- 실행 스택

- 지역 변수와 스레드의 특정 데이터를 저장하기 위한 스레드별 정적 저장소

- 프로세스의 다른 스레드가 공유하는 프로세스의 메모리와 자원에 대한 접근 같은 스레드 실행 환경 정보(문맥 정보)

스레드를 사용하면 자원을 공유하여 한 프로세스에서 동시 작업이 가능하다. 즉, 프로세스에 포함된 스레드들은 공통의 목적을 달성하기 위해 병렬로 수행된다. 또한 하나의 프로세스가 서로 다른 프로세서에서 프로그램의 다른 부분을 동시에 실행시킬 수 있으므로 시스템의 성능과 효율을 향상시킨다. 따라서 응용 프로그램 하나가 비슷한 작업들을 여러 개 수행할 수 있다.

---
##### 사용자에 대한 응답성 증가
---
응용 프로그램에서 일부분이 봉쇄되거나 긴 작업을 수행해도 프로그램 실행을 계속 허용하여 사용자에 대한 응답성이 증가한다. 예를 들면, 다중 스레드가 적용된 웹 브라우저는 스레드 하나가 파일을 적재하는 동안, 다른 스레드에서 사용자와 상호작용이 가능하다. 

---
##### 프로세스의 자원과 메모리 공유 기능
---
스레드는 그들이 속한 프로세스의 자원과 메모리를 공유한다. 그러므로 응용 프로그램 하나가 같은 주소 공간에서 여러 개의 스레드를 실행해 시스템 성능을 향상시키고 편리함을 제공한다.

---
##### 경제성
---
스레드는 한 프로세스의 자원을 공유한다. 그러므로 메모리와 자원을 할당해 프로세스를 생성하는 것보다 스레드를 생성하여 문맥 교환하는 것이 오버헤드를 줄인다.

---
#### 다중 프로세서 구조 활용 가능
---
다중 프로세서 구조에서 각 스레드는 다른 프로세서에서 병렬로 실행될 수 있다.

---
### 단일 스레드와 다중 스레드
---
운영체제는 단일 프로세스에서 단일 스레드 실행과 다중 스레드 실행을 지원한다. 

단일 스레드를 지원하는 운영체제는 프로세스 하나에 스레드 하나가 실행되는 전통적인 방식으로 스레드의 개념이 불확실하다. 대표 예가 MS-DOS다. 다중 스레드 운영체제는 프로세스 하나에 스레드를 실행하는 것을 지원하는 형태로 윈도우 NT/XP, 솔라리스 등이 이에 해당한다. 물론 프로그램 하나를 여러 실행 단위로 쪼개어 실행한다는 측면에서(각 스레드를 별도의 프로세서에서 실행) 다중 프로세싱(프로세서)과 같은 의미다. 하지만 동일한 동일 프로세스 내의 스레드는 메모리와 파일을 공유하기 때문에, 프로세스 하나에 다수의 실행 단위로 구분된 자원을 공유하므로 자원 생성과 관리의 중복성을 최소화하여 실행 능력을 향상시킬 수 있다. 이때 각 스레드는 커널 개입 없이 서로 통신이 가능하여 독립적으로 실행할 수 있어 서버에서 많은 요청을 효과적으로 처리할 수 있는 환경을 제공해준다. 

단일 스레드 프로세스 모델은 프로세스를 하나의 스레드, 즉 스레드가 가진 레지스터와 스택으로 표현한다. 반면 다중 스레드 프로세스 모델은 프로세스를 각각의 스레드와 고유의 레지스터, 스택으로 표현하며 프로세스 주소 영역을 모든 스레드가 공유한다. 따라서 프로세스의 모든 스레드는 해당 프로세스의 자원과 상태를 공유하고, 같은 주소 공간에 존재하며, 동일한 데이터에 접근한다. 이때 스레드 하나가 메모리에 있는 데이터 항목을 변경하면 다른 스레드도 이 항목에 접근하여 변경 결과를 확인할 수 있다. 또한 스레드 하나가 읽기 권한으로 파일을 열면 같은 프로세스의 다른 스레드도 이 파일을 읽을 수 있다. 이러한 스레드의 특성은 프로세스의 생성과 종료 과정에 매우 유용하다.

이러한 스레드의 특성으로 프로세스를 새로 생성하는 것보다 기존 프로세스에서 스레드를 생성하는 것이 빠르고, 같은 프로세스에 있는 스레드 간 교환이나 스레드 종료도 훨씬 빠르다.

따라서 스레드는 프로세스의 상대적인 무게를 줄여 효율을 극대화하는 것을 목표로, 프로그램 변경 없이 프로세서의 개수에 따라 스레드를 병렬로 처리할 수 있다.

스레드별로 레지스터 상태를 가지지만 서로 공유를 많이 하기 때문에 같은 그룹의 스레드에 프로세서를 할당하거나 스레드를 생성할 때 중량 프로세스들 사이의 문맥교환과 비교하면 훨씬 경제적이다. 















































